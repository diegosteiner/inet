%description:
In this example there are two possible routes between the sender and the receiver.
This tests demonstrates that the AODV chooses the shortest path, that is, the route
which has the lowest hop count.
%#--------------------------------------------------------------------------------------------------------------
%file: test.ned
import inet.base.LifecycleController;
import inet.networklayer.autorouting.ipv4.IPv4NetworkConfigurator;
import inet.networklayer.ipv4.RoutingTableRecorder;
import inet.nodes.aodv.AODVRouter;
import inet.physicallayer.radio.ideal.IdealRadioChannel;
import inet.world.scenario.ScenarioManager;

network AODVTest
{
    parameters:
        @display("bgb=961,662");
    submodules:
        radioChannel: IdealRadioChannel {
            parameters:
                @display("p=50,50");
        }
        configurator: IPv4NetworkConfigurator {
            parameters:
                addDefaultRoutes = false;
                addStaticRoutes = false;
                addSubnetRoutes = false;
                config = xml("<config><interface hosts='*' address='145.236.x.x' netmask='255.255.0.0'/></config>");
                @display("p=50,100");
        }
        routingTableRecorder: RoutingTableRecorder {
            parameters:
                @display("p=50,150");
        }
        lifecycleController: LifecycleController {
            parameters:
                @display("p=50,200");
        }
        scenarioManager: ScenarioManager {
            parameters:
                script = default(xml("<scenario/>"));
                @display("p=50,250");
        }
        sender: AODVRouter {
            parameters:
                @display("i=device/pocketpc_s;r=,,#707070;p=283,63");
        }
        intermediateNodeA: AODVRouter {
            parameters:
                @display("i=device/pocketpc_s;r=,,#707070;p=203,206");
        }
        intermediateNodeB: AODVRouter {
            parameters:
                @display("i=device/pocketpc_s;r=,,#707070;p=385,256");
        }
        intermediateNodeC: AODVRouter {
            parameters:
                @display("i=device/pocketpc_s;r=,,#707070;p=292,325");
        }
        receiver: AODVRouter {
            parameters:
                @display("i=device/pocketpc_s;r=,,#707070;p=292,454");
        }
    connections allowunconnected:
}


%#--------------------------------------------------------------------------------------------------------------
%inifile: omnetpp.ini
[General]
network = AODVTest
record-eventlog = true
tkenv-plugin-path = ../../../etc/plugins
ned-path = .;../../../../src;../../lib
num-rngs = 3
sim-time-limit = 100s
**.mobility.rng-0 = 1
**.wlan[*].mac.rng-0 = 2
**.aodv.useHelloMessages = false
*.sender.aodv.jitter = 1ms
*.receiver.aodv.jitter = 2ms
*.intermediateNodeA.aodv.jitter = 3ms
*.intermediateNodeB.aodv.jitter = 4ms
# mobility
**.mobilityType = "StationaryMobility"
**.mobility.constraintAreaMinZ = 0m
**.mobility.constraintAreaMaxZ = 0m
**.mobility.constraintAreaMinX = 0m
**.mobility.constraintAreaMinY = 0m
**.mobility.constraintAreaMaxX = 600m
**.mobility.constraintAreaMaxY = 600m

# ping app (host[0] pinged by others)
**.sender.numPingApps = 1
**.sender.pingApp[0].startTime = uniform(1s,5s)
**.sender.pingApp[0].printPing = true
**.sender.pingApp[0].destAddr = "receiver(ipv4)"

# nic settings
**.wlan[*].typename = "IdealWirelessNic"
**.wlan[*].radio.transmissionRange = 240m
**.wlan[*].bitrate = 2Mbps
**.wlan[*].mac.address = "auto"
**.wlan[*].mac.headerLength = 20B


%#--------------------------------------------------------------------------------------------------------------
%contains-regex: results/General-0.rt
.*
\+R 46  3\.196414555783  8  145\.236\.0\.2  145\.236\.0\.1  32  145\.236\.0\.1
\+R 50  3\.196414737372  9  145\.236\.0\.3  145\.236\.0\.1  32  145\.236\.0\.1
\+R 65  3\.199575051459  10  145\.236\.0\.4  145\.236\.0\.2  32  145\.236\.0\.2
\+R 65  3\.199575051459  10  145\.236\.0\.4  145\.236\.0\.1  32  145\.236\.0\.2
\+R 69  3\.199575102349  7  145\.236\.0\.1  145\.236\.0\.2  32  145\.236\.0\.2
\+R 73  3\.199575185362  9  145\.236\.0\.3  145\.236\.0\.2  32  145\.236\.0\.2
\+R 87  3\.200575123644  10  145\.236\.0\.4  145\.236\.0\.3  32  145\.236\.0\.3
\+R 91  3\.200575366951  8  145\.236\.0\.2  145\.236\.0\.3  32  145\.236\.0\.3
\+R 95  3\.200575465527  7  145\.236\.0\.1  145\.236\.0\.3  32  145\.236\.0\.3
\+R 99  3\.200575467054  11  145\.236\.0\.5  145\.236\.0\.3  32  145\.236\.0\.3
\+R 99  3\.200575467054  11  145\.236\.0\.5  145\.236\.0\.1  32  145\.236\.0\.3
\+R 152  3\.2011216561  9  145\.236\.0\.3  145\.236\.0\.5  32  145\.236\.0\.5
\+R 213  3\.205667840565  7  145\.236\.0\.1  145\.236\.0\.5  32  145\.236\.0\.3
\-R 512  6\.199575051459  10  145\.236\.0\.4  145\.236\.0\.2  32  145\.236\.0\.2
\-R 513  6\.199575102349  7  145\.236\.0\.1  145\.236\.0\.2  32  145\.236\.0\.2
\-R 514  6\.199575185362  9  145\.236\.0\.3  145\.236\.0\.2  32  145\.236\.0\.2
\-R 515  6\.200575123644  10  145\.236\.0\.4  145\.236\.0\.3  32  145\.236\.0\.3
\-R 516  6\.200575366951  8  145\.236\.0\.2  145\.236\.0\.3  32  145\.236\.0\.3
\-R 670  8\.639575051459  10  145\.236\.0\.4  145\.236\.0\.1  32  145\.236\.0\.2
\-R 671  8\.716414555783  8  145\.236\.0\.2  145\.236\.0\.1  32  145\.236\.0\.1
%#--------------------------------------------------------------------------------------------------------------
%not-contains: stdout
undisposed object:
%not-contains: stdout
-- check module destructor
%#--------------------------------------------------------------------------------------------------------------
