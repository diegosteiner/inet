%description:
This example tests a single route request with two intermediate nodes
between the sender and the receiver. The two intermediate nodes are
placed to the same distance from both the receiver and the sender.
%#--------------------------------------------------------------------------------------------------------------
%file: test.ned

import inet.base.LifecycleController;
import inet.networklayer.autorouting.ipv4.IPv4NetworkConfigurator;
import inet.networklayer.ipv4.RoutingTableRecorder;
import inet.nodes.aodv.AODVRouter;
import inet.physicallayer.radio.ideal.IdealRadioChannel;
import inet.world.scenario.ScenarioManager;


network AODVTest
{
    parameters:
        @display("bgb=961,662");
    submodules:
        radioChannel: IdealRadioChannel {
            parameters:
                @display("p=50,50");
        }
        configurator: IPv4NetworkConfigurator {
            parameters:
                addDefaultRoutes = false;
                addStaticRoutes = false;
                addSubnetRoutes = false;
                config = xml("<config><interface hosts='*' address='145.236.x.x' netmask='255.255.0.0'/></config>");
                @display("p=50,100");
        }

        routingTableRecorder: RoutingTableRecorder {
            parameters:
                @display("p=50,150");
        }
        lifecycleController: LifecycleController {
            parameters:
                @display("p=50,200");
        }
        scenarioManager: ScenarioManager {
            parameters:
                script = default(xml("<scenario/>"));
                @display("p=50,250");
        }
        sender: AODVRouter {
            parameters:
                @display("i=device/pocketpc_s;r=,,#707070;p=284,51");
        }
        intermediateNodeA: AODVRouter {
            parameters:
                @display("i=device/pocketpc_s;r=,,#707070;p=203,206");
        }
        intermediateNodeB: AODVRouter {
            parameters:
                @display("i=device/pocketpc_s;r=,,#707070;p=386,206");
        }
        receiver: AODVRouter {
            parameters:
                @display("i=device/pocketpc_s;r=,,#707070;p=284,378");
        }
    connections allowunconnected:
}

%#--------------------------------------------------------------------------------------------------------------
%inifile: omnetpp.ini
[General]
network = AODVTest
record-eventlog = true
sim-time-limit = 100s
num-rngs = 3
tkenv-plugin-path = ../../../etc/plugins
ned-path = .;../../../../src;../../lib
**.mobility.rng-0 = 1
**.wlan[*].mac.rng-0 = 2
**.aodv.useHelloMessages = false
*.sender.aodv.jitter = 1ms
*.receiver.aodv.jitter = 2ms
*.intermediateNodeA.aodv.jitter = 3ms
*.intermediateNodeB.aodv.jitter = 4ms
# mobility
**.mobilityType = "StationaryMobility"
**.mobility.constraintAreaMinZ = 0m
**.mobility.constraintAreaMaxZ = 0m
**.mobility.constraintAreaMinX = 0m
**.mobility.constraintAreaMinY = 0m
**.mobility.constraintAreaMaxX = 600m
**.mobility.constraintAreaMaxY = 600m

# ping app (host[0] pinged by others)
**.sender.numPingApps = 1
**.sender.pingApp[0].startTime = uniform(1s,5s)
**.sender.pingApp[0].printPing = true
**.sender.pingApp[0].destAddr = "receiver(ipv4)"

# nic settings
**.wlan[*].typename = "IdealWirelessNic"
**.wlan[*].radio.transmissionRange = 240m
**.wlan[*].bitrate = 2Mbps
**.wlan[*].mac.address = "auto"
**.wlan[*].mac.headerLength = 20B


%#--------------------------------------------------------------------------------------------------------------
%contains-regex: results/General-0.rt
.*
\+R 39  3\.196414592582  8  145\.236\.0\.2  145\.236\.0\.1  32  145\.236\.0\.1
\+R 43  3\.196414628146  9  145\.236\.0\.3  145\.236\.0\.1  32  145\.236\.0\.1
\+R 56  3\.199575175947  7  145\.236\.0\.1  145\.236\.0\.2  32  145\.236\.0\.2
\+R 60  3\.199575203004  9  145\.236\.0\.3  145\.236\.0\.2  32  145\.236\.0\.2
\+R 64  3\.199575226748  10  145\.236\.0\.4  145\.236\.0\.2  32  145\.236\.0\.2
\+R 64  3\.199575226748  10  145\.236\.0\.4  145\.236\.0\.1  32  145\.236\.0\.2
\+R 109  3\.200121129246  8  145\.236\.0\.2  145\.236\.0\.4  32  145\.236\.0\.4
\+R 124  3\.200575238568  8  145\.236\.0\.2  145\.236\.0\.3  32  145\.236\.0\.3
\+R 128  3\.200575247075  7  145\.236\.0\.1  145\.236\.0\.3  32  145\.236\.0\.3
\+R 132  3\.200575295174  10  145\.236\.0\.4  145\.236\.0\.3  32  145\.236\.0\.3
\+R 179  3\.203666879341  7  145\.236\.0\.1  145\.236\.0\.4  32  145\.236\.0\.2
\-R 437  6\.199575203004  9  145\.236\.0\.3  145\.236\.0\.2  32  145\.236\.0\.2
\-R 439  6\.200575238568  8  145\.236\.0\.2  145\.236\.0\.3  32  145\.236\.0\.3
\-R 440  6\.200575247075  7  145\.236\.0\.1  145\.236\.0\.3  32  145\.236\.0\.3
\-R 441  6\.200575295174  10  145\.236\.0\.4  145\.236\.0\.3  32  145\.236\.0\.3
\-R 572  8\.716414628146  9  145\.236\.0\.3  145\.236\.0\.1  32  145\.236\.0\.1
%#--------------------------------------------------------------------------------------------------------------
%not-contains: stdout
undisposed object:
%not-contains: stdout
-- check module destructor
%#--------------------------------------------------------------------------------------------------------------
